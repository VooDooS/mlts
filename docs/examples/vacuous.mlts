type utm =
| App of utm * utm
| Abs of utm => utm
;;

let vacp t =
  match t with
  | Abs(r) -> new X in
    let rec aux term =
      match term with
      | X -> false
      | nab Y in Y -> true
      | App(m, n) -> (aux m) && (aux n)
      | Abs(r) -> new Y in aux (r @ Y)
    in aux (r X)
;;	
	    
vacp (Abs(x\ x));;
vacp (Abs(x\ App(x, x)));;
vacp (Abs(x\ Abs(y\ y)));;	